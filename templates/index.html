{% extends 'base.html' %} {% block content %}
<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="card shadow">
      <div class="card-header bg-primary text-white">
        <h1 class="h4 mb-0">
          <i class="fas fa-barcode me-2"></i>バーコードスキャナー
        </h1>
      </div>
      <div class="card-body">
        <p class="lead">
          バーコードが含まれる画像をアップロードして商品情報を取得
        </p>

        <form id="barcode-form" enctype="multipart/form-data">
          <div class="mb-3">
            <label for="image-upload" class="form-label"
              >バーコードが含まれる画像を選択してください</label
            >
            <input
              class="form-control"
              type="file"
              id="image-upload"
              name="image"
              accept="image/*"
              required
            />
            <div class="form-text">対応フォーマット: JPG, PNG, GIF</div>
          </div>

          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary" id="scan-button">
              <i class="fas fa-search me-2"></i>バーコードをスキャン
            </button>
          </div>
        </form>

        <div id="loading-indicator" class="text-center my-4 d-none">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">読み込み中...</span>
          </div>
          <p class="mt-2">画像を処理中です。お待ちください...</p>
        </div>

        <div
          id="error-message"
          class="alert alert-danger mt-3 d-none"
          role="alert"
        >
          <i class="fas fa-exclamation-triangle me-2"></i>
          <span id="error-text"></span>
        </div>

        <div id="result-container" class="mt-4 d-none">
          <hr />
          <h2 class="h5 mb-3">スキャン結果</h2>

          <div class="card mb-3 bg-primary">
            <div class="card-body">
              <h3 class="h6 mb-2">バーコード情報</h3>
              <p class="mb-1">
                <strong>バーコード番号:</strong>
                <span id="barcode-number" class="fw-bold"></span>
              </p>
              <p><strong>タイプ:</strong> <span id="barcode-type"></span></p>
            </div>
          </div>

          <div class="card bg-dark">
            <div class="card-body">
              <h3 class="h6 mb-3">商品情報</h3>
              <table class="table table-sm">
                <tbody>
                  <tr>
                    <th scope="row" style="width: 120px">商品名</th>
                    <td id="product-name"></td>
                  </tr>
                  <tr>
                    <th scope="row">メーカー</th>
                    <td id="product-manufacturer"></td>
                  </tr>
                  <tr>
                    <th scope="row">カテゴリ</th>
                    <td id="product-category"></td>
                  </tr>
                  <tr>
                    <th scope="row">説明</th>
                    <td id="product-description"></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card shadow mt-4">
      <div class="card-header bg-info text-white">
        <h2 class="h5 mb-0"><i class="fas fa-info-circle me-2"></i>使い方</h2>
      </div>
      <div class="card-body">
        <ol class="mb-0">
          <li>バーコード（EAN、UPCなど）が含まれる画像をアップロード</li>
          <li>システムがバーコードをスキャンして数字に変換</li>
          <li>データベースから商品情報を検索</li>
          <li>結果がすぐに表示されます</li>
        </ol>
      </div>
    </div>

    <div class="card shadow mt-4">
      <div class="card-header bg-secondary text-white">
        <h2 class="h5 mb-0">
          <i class="fas fa-question-circle me-2"></i>スキャンのコツ
        </h2>
      </div>
      <div class="card-body">
        <ul class="mb-0">
          <li>バーコードが画像内ではっきりと見えるようにする</li>
          <li>明るい場所での撮影が正確な検出に役立つ</li>
          <li>ぼやけた画像は避ける</li>
          <li>バーコード全体がフレーム内に収まっていることを確認</li>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}
